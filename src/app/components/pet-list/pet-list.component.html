<div
  class="flex items-center justify-between mb-8 px-6 py-4 bg-white rounded-xl shadow-lg"
>
  <h1 class="text-3xl font-extrabold text-gray-800">Lista Zwierząt</h1>
  <button
    mat-raised-button
    color="primary"
    (click)="openAddPet()"
    [attr.data-cy]="'add-pet-btn'"
    class="px-6 py-3 bg-gradient-to-r from-indigo-600 to-blue-600 text-white font-semibold rounded-lg shadow-md hover:from-indigo-700 hover:to-blue-700 transition duration-300"
  >
    Dodaj Zwierzę +
  </button>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-10 px-6">
  <mat-form-field appearance="fill" class="w-full">
    <mat-label>Wyszukaj po nazwie</mat-label>
    <input
      matInput
      [(ngModel)]="filterName"
      (ngModelChange)="applyFilter()"
      placeholder="Wpisz nazwę..."
      [attr.data-cy]="'search-input'"
    />
  </mat-form-field>

  <mat-form-field appearance="fill" class="w-full">
    <mat-label>Status</mat-label>
    <mat-select
      [(ngModel)]="filterStatus"
      (selectionChange)="onStatusChange()"
      [attr.data-cy]="'status-select'"
    >
      <mat-option value="all" [attr.data-cy]="'status-option-all'"
        >All</mat-option
      >
      <mat-option value="available" [attr.data-cy]="'status-option-available'"
        >available</mat-option
      >
      <mat-option value="pending" [attr.data-cy]="'status-option-pending'"
        >pending</mat-option
      >
      <mat-option value="sold" [attr.data-cy]="'status-option-sold'"
        >sold</mat-option
      >
    </mat-select>
  </mat-form-field>
</div>

<div class="px-6 pet-list-table">
  <ng-container *ngIf="isLoading">
    <mat-spinner
      [attr.data-cy]="'loading-spinner'"
      class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"
    ></mat-spinner>
  </ng-container>
  <div class="overflow-x-auto bg-white rounded-xl shadow-lg">
    <table
      mat-table
      [dataSource]="dataSource"
      matSort
      [attr.data-cy]="'pets-table'"
    >
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>
        <td mat-cell *matCellDef="let pet" [attr.data-cy]="'pet-id-' + pet.id">
          {{ pet.id }}
        </td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Nazwa</th>
        <td
          mat-cell
          *matCellDef="let pet"
          [attr.data-cy]="'pet-name-' + pet.id"
        >
          {{ pet.name }}
        </td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
        <td
          mat-cell
          *matCellDef="let pet"
          [attr.data-cy]="'pet-status-' + pet.id"
        >
          {{ pet.status }}
        </td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Akcje</th>
        <td mat-cell *matCellDef="let pet">
          <button
            mat-button
            (click)="editPet(pet)"
            [attr.data-cy]="'edit-pet-btn-' + pet.id"
          >
            Edytuj
          </button>
          <button
            mat-button
            (click)="viewDetails(pet)"
            [attr.data-cy]="'details-pet-btn-' + pet.id"
          >
            Szczegóły
          </button>
          <button
            mat-button
            color="warn"
            (click)="onDelete(pet)"
            [attr.data-cy]="'delete-pet-btn-' + pet.id"
          >
            Usuń
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>
</div>

<mat-paginator
  [pageSizeOptions]="[5, 10, 20]"
  [attr.data-cy]="'pagination'"
></mat-paginator>
